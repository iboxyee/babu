!function(t){"use strict";t.dlxQuiz=function(e,s){var i=this,o=t(e),n=o.attr("id"),a="#"+n,u=0,c=0,l=s.quizData,r=null,d=null,h="selectedAnswer",p=" .ctrlDone.button.button--material",f=a+" .quizQuestions > li",m=a+" .questionAnswers li",b=a+" .quizControls",q=a+" .ctrlPrev.button.button--material",z=a+" .ctrlNext.button.button--material",v=a+p,g=a+" .viewResults.button.button--material",x=a+" .quizResults";if(i.config=t.extend({questionCount_text:"Question %current_index of %totalQuestions",backButton_text:"Previous Question",nextButton_text:"Next Question",completeButton_text:"Finish Quiz",viewResultsButton_text:"Showing Results",resultsHeader_text:"",quizScore_text:"You've got %totalScore out of %totalQuestions questions correct!",quizScoreMessage_text:"",quizScoreRank_text:{p:"Perfect Score!",a:"Great Job!",b:"Almost There!",c:"Not Bad!",d:"Please Study!",f:"Please Study!"},show_QuestionCount:!0,showBackButton:!0,showRadioButtons:!0,showScoreRank:!0,showScoreMessage:!0,showViewResultsButton:!0,showCorrectAnswer:!1,randomizeQuestions:!0,randomizeAnswers:!0},s),i.method={intToAlpha:function(t){var e="";return 0==t&&(e="A"),1==t&&(e="B"),2==t&&(e="C"),3==t&&(e="D"),e},buildQuiz:function(e){var s;l=e,r=i.config.randomizeQuestions?i.method.randomizeArray(l.questions):l.questions,d=r.length,o.hasClass("quiz")||o.addClass("quiz"),s='<ul class="quizQuestions">',t.each(r,function(e){var o=r[e];if(o.options=i.config.randomizeAnswers?i.method.randomizeArray(o.options):o.options,s+="<li",s+=0===e?' class="showQuestion">':">",i.config.show_QuestionCount&&(s+='<span class="questionCount">',s+=i.config.questionCount_text.replace("%current_index",e+1).replace("%totalQuestions",d),s+="</span>"),void 0===o.choices)s+='<p class="questionTitle">',s+=o.q,s+="</p>";else{s+='<p class="questionTitle">'+o.q+"</p>",s+='<div class="row">';for(var a=0;a<o.choices.length;a++)s+='<div class="col-md-6"><span class="alpha">'+i.method.intToAlpha(a)+'.</span><textarea class="cm">',s+=o.choices[a],s+="</textarea></div>";s+="</div>"}s+='<ul class="questionAnswers list op">',t.each(o.options,function(t){var a=n+"-q"+(e+1),u=a+"-a"+(t+1);s+='<li class="list-item list-item--tappable">',s+='<label for="'+u+'" class="checkbox">',s+="<input ",s+=i.config.showRadioButtons?'class="checkbox__input"':'class="hidden" ',s+='type="radio" name="',s+=a+'"',s+=' id="'+u+'"',s+=' value="'+escapeHtml(o.options[t])+'">',s+='<div class="checkbox__checkmark"></div>&nbsp;&nbsp;&nbsp;',s+=escapeHtml(o.options[t]),s+="</label>",s+="</li>"}),s+="</ul>",s+="</li>",e+=1}),s+="</ul>",s+='<div class="quizControls">',i.config.showBackButton&&(s+='<button class="ctrlPrev button button--material">',s+=i.config.backButton_text+"</button>"),s+='<button class="ctrlNext button button--material disabled">',s+=i.config.nextButton_text+"</button>",s+='<button class="ctrlDone button button--material disabled">',s+=i.config.completeButton_text+"</button>",s+="</div>",previous_result(),previous_result_score==d?ons.notification.confirm({class:"confirm-take-quiz-again",cancelable:!0,message:"Are you sure to take this quiz again?",buttonLabels:["Cancel","Yes"],callback:function(e){1==e&&(exit_quiz_immediately=!1,t("#quiz1").html(""),t(".quizMoreOptions").html(""),o.append(s),quiz_initcm(),i.events.init(),t(" .quizReminder").text("You can still cancel this quiz to not override your perfect score."))}}):(exit_quiz_immediately=!1,t("#quiz1").html(""),t(".quizMoreOptions").html(""),o.append(s),quiz_initcm(),i.events.init(),t(" .quizReminder").text(""))},randomizeArray:function(t){for(var e,s,i=t.length;i;)s=Math.floor(Math.random()*i--),e=t[i],t[i]=t[s],t[s]=e;return t},buildQuizResults:function(){var e,n="",a=0;t.each(r,function(t){r[t].answerCorrect=r[t].selected===r[t].a,r[t].answerCorrect?a+=1:a=a}),localStorage.setItem(s.section+"_score",a),localStorage.setItem(s.section+"_max_score",r.length),u=e=a/d*100,n+='<div class="quizResults">',n+='<h1 class="quizScoreRank">';100==e?(n+=i.config.quizScoreRank_text.p,i.config.quizScoreRank_text.p):e>80?(n+=i.config.quizScoreRank_text.a,i.config.quizScoreRank_text.a):e>60?(n+=i.config.quizScoreRank_text.b,i.config.quizScoreRank_text.b):e>40?(n+=i.config.quizScoreRank_text.c,i.config.quizScoreRank_text.c):e>20?(n+=i.config.quizScoreRank_text.d,i.config.quizScoreRank_text.d):e>=0&&(n+=i.config.quizScoreRank_text.f,i.config.quizScoreRank_text.f),n+="</h1>",n+='<p class="quizScore">',n+=i.config.quizScore_text.replace("%totalScore",a).replace("%totalQuestions",'<span id="quiz-no-of-items">'+d+"</span>"),n+="</p>",n+='<span id="previous-result-score">'+a+"</span>",i.config.showScoreMessage&&(n+='<p class="quizScoreMessage">',n+=i.config.quizScoreMessage_text,n+="</p>"),i.config.showViewResultsButton&&(n+='<button class="viewResults button button--material">',n+=i.config.viewResultsButton_text,n+="</button>"),n+="</div>";var c=parseInt(localStorage.getItem("06-04"));null==localStorage.getItem(s.section)?localStorage.setItem("06-04",c+a):localStorage.setItem("06-04",c+a-previous_result_score);var l=escapeHtml(n);localStorage.setItem(s.section,l),o.append(n),i.config.showViewResultsButton&&(i.events.resultsButton(),t(" .viewResults.button.button--material").click(),exit_quiz_immediately=!0)}},i.events={init:function(){this.controls.init(),this.answerQuestion(),this.checkQuestion()},controls:{DOM:function(){this.plugin=i.events,this.questionCount=d-1,this.$previous=t(q),this.$next=t(z),this.$complete=t(v),this.$buttons=this.$previous.add(this.$next).add(this.$complete)},init:function(){this.DOM();var e=this.$buttons,s=this;e.on("click",function(){var e=t(this);if(s.isNotDisabled(e))switch(e.attr("class")){case"ctrlPrev button button--material":s.plugin.previousQuestion();break;case"ctrlNext button button--material":s.plugin.nextQuestion();break;case"ctrlDone button button--material":show_ad?(showInterstitial(),show_ad=!1,t(p).html('Building Quiz Results <i class="fa fa-spinner fa-spin"></i>'),t(p).prop("disabled",!0),setTimeout(function(){t(a+"  .quizQuestions").add(b).remove(),i.method.buildQuizResults(),t(p).prop("disabled",!1)},1e3)):(t(a+"  .quizQuestions").add(b).remove(),i.method.buildQuizResults())}})},isNotDisabled:function(t){return!t.hasClass("disabled")},resetDisabled:function(){var e=0;switch(c){case 0:this.$previous.addClass("disabled"),this.$complete.hide(),this.$next.show();break;case this.questionCount:this.$next.addClass("disabled").hide(),this.$previous.removeClass("disabled"),this.$complete.show();break;default:this.$previous.removeClass("disabled"),this.$next.show(),this.$complete.hide()}this.$next=void 0!==r[c].selected?this.$next.removeClass("disabled"):this.$next.addClass("disabled"),t.each(r,function(t){e=r[t].selected?e+=1:e=e}),e===d&&this.$complete.removeClass("disabled")}},nextQuestion:function(){c+=1,this.checkQuestion(),t(".CodeMirror").each(function(t,e){e.CodeMirror.refresh()})},previousQuestion:function(){c-=1,this.checkQuestion()},checkQuestion:function(){this.controls.resetDisabled(),t(f).removeClass("showQuestion"),t(t(f)[c]).addClass("showQuestion")},answerQuestion:function(){t(m+" input").on("click",function(e){var s=t(this),o=s.parent().parent();t('input:radio[name="'+s.prop("name")+'"]').parent().parent().removeClass(h),o.addClass(h),r[c].selected=s.val(),i.events.checkQuestion()})},resultsButton:function(){t(g).on("click",function(){var e;t(g).remove(),e="<h2>"+i.config.resultsHeader_text+"</h2>",e+='<ul class="showingResults">';var o=!0;t.each(r,function(t){r[t].answerCorrect||(o=!1),e+='<li class="',e+=r[t].answerCorrect?"answeredCorrect":"answeredWrong",e+='">';var s=t+1+". "+r[t].q,n=s.search(/<br>/);-1!=n&&(s=s.substr(0,n)),e+='<p class="questionTitle" style="font-weight: 500">',e+=s,e+="</p>",e+="<p>",r[t].answerCorrect?(e+='<i class="fa fa-check"></i>&nbsp; ',e+=escapeHtml(r[t].a)+"<br>"):(e+='<i class="fa fa-remove"></i> ',e+=escapeHtml(r[t].selected)+"<br>",i.config.showCorrectAnswer&&(e+='<i class="fa fa-check"></i> ',e+=escapeHtml(r[t].a)+"<br>")),e+="</p>",e+="</li>"}),e+="</ul>",u<100&&(e+='<div class="small"> Tip! You can review the question/s you\'ve answered incorrectly then take the whole quiz again.  </div>'),t(" .quizReminder").text(""),t(x).append(e),t(x).parent().parent().parent().scrollTop(0),o?t(".quizMoreOptions").html('<ons-button class="full sqr" onclick="paint_quiz_results()"> share quiz results </ons-button>'):t(".quizMoreOptions").html('<ons-button class="full" onclick="'+s.section+'_q()"> retake quiz </ons-button><ons-button class="full sqr" onclick="paint_quiz_results()"> share quiz results </ons-button>')})}},l)if("string"==typeof l)t.getJSON(l).then(function(t){i.method.buildQuiz(t)});else{if("object"!=typeof s.quizData)throw l=null,"Error: Check quizData for - "+a;i.method.buildQuiz(l)}},t.fn.dlxQuiz=function(e){return this.each(function(){new t.dlxQuiz(this,e)})}}(jQuery);